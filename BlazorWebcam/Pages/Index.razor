@page "/"
@inject IJSRuntime JSRuntime

<h3 class="text-center mb-4">Webcam Control Panel</h3>

<div class="main-container">
    <!-- Reference to the Canvas component -->
    <BlazorWebcam.Shared.Components.Canvas @ref="canvasRef" />
    <div class="controls-container">
        <!-- Button to start recording -->
        <button class="btn btn-primary btn-block mb-2" @onclick="StartRecording">Start Recording</button>

        <!-- Button to start pose estimation -->
        <button class="btn btn-info btn-block" @onclick="StartPoseEstimation">Start Pose Estimation</button>
    </div>
</div>

@code {
    // Reference to the Canvas component to invoke its methods
    private BlazorWebcam.Shared.Components.Canvas canvasRef;

    // Method to start recording the webcam feed
    private async Task StartRecording()
    {
        // Start the webcam feed
        await canvasRef.StartVideo();

        // Call the JavaScript function "startRecording" and pass the video element ID
        await JSRuntime.InvokeVoidAsync("startRecording", "videoFeed");
    }

    // Method to start pose estimation using Mediapipe
    private async Task StartPoseEstimation()
    {
        // Start the webcam feed
        await canvasRef.StartVideo();

        // Call the JavaScript function "startPoseEstimation"
        // Pass the video element ID and canvas ID for drawing landmarks
        await JSRuntime.InvokeVoidAsync("startPoseEstimation", "videoFeed", "landmarkCanvas");
    }
}
